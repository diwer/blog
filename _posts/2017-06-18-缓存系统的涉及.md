---
title: 缓存系统的思考 
tags: [redis]
date: 2017-06-18 22:43:23
grammar_cjkRuby: true
---
日期: 2017-06-18 22:43:23

# 缓存系统的思考
在凡客的时候接触到redis的使用，当时没有特别在意缓存对系统的影响，也没有考虑过多缓存系统的设计，缓存对于大流量系统的重要性不言而喻
## redis的使用
redis 作为缓存已经非常普遍，集群高可用方案很成熟，
redis在没有官方集群方案时，为保障缓存的高可用，可以使用多机器多实例多份保存
凡客就是依次设计，三台redis实例，轮询保存，查询时，第一台失败，则查询第二台，依次进行，当三台都失败则读库。假设每台redis机器宕机可能性1%，若是缓存完全不可用出现的概率则为1%*1%*1%，加上宕机报警，可以说能满足正常需求缓存系统的高可用，但是redis单机20gb的存储是大家熟知的性能最优，value值最好在100m以内 如此计算对于大value值存储仅有200条记录，当然这样子也不会合理，但是这说明一个问题也就是redis单机容量并不能够满足，所以对于缓存key需要归类划分不同机器做高可用，对值大小也要做这种规划。这样导致的结果为你机器很多 管理不易。就必须依赖一台机器作为配置中心。来统一管理。配置中心对外提供服务，对内决定存储位置。但是配置中心宕机则意味着系统雪崩。配置中心就要做高可用的配置。这样就有两层高可用，一是存储是的高可用，而是查询时的高可用。极大的增加了复杂度
redis 后面推出了主从复制，复制方式分为两种，主从很好的处理了我们对存储的高可用的需求，但是主从复制对redis服务能力的限制也是有的。这样子 我们对配置中心的要求就要更加的多。
![enter description here][1]
如图类似结构配置中心控制redis master的使用频率和使用容量，来保证redis顺利的保证主从同步，并对外提供正常的查询任务。配置中心 控制容量和存储位置。


----

wanheming1991@gmail.com


  [1]: http://oq6m1y13p.bkt.clouddn.com/1497795041416.jpg